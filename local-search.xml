<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>docker</title>
    <link href="/blog/2023/05/19/Dockerfile/"/>
    <url>/blog/2023/05/19/Dockerfile/</url>
    
    <content type="html"><![CDATA[<h2 id="制作自己的镜像"><a href="#制作自己的镜像" class="headerlink" title="制作自己的镜像"></a>制作自己的镜像</h2><h3 id="编写-Dockerfile文件"><a href="#编写-Dockerfile文件" class="headerlink" title="编写 Dockerfile文件"></a>编写 Dockerfile文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ FROM node:11<br>MAINTAINER easydoc.net<br><br><span class="hljs-comment"># 复制代码</span><br>ADD . /app<br><br><span class="hljs-comment"># 设置容器启动后的默认运行目录</span><br>WORKDIR /app<br><br><span class="hljs-comment"># 运行命令，安装依赖</span><br><span class="hljs-comment"># RUN 命令可以有多个，但是可以用 &amp;&amp; 连接多个命令来减少层级。</span><br><span class="hljs-comment"># 例如 RUN npm install &amp;&amp; cd /app &amp;&amp; mkdir logs</span><br>RUN npm install --registry=https://registry.npm.taobao.org<br><br><span class="hljs-comment"># CMD 指令只能一个，是容器启动后执行的命令，算是程序的入口。</span><br><span class="hljs-comment"># 如果还需要运行其他命令可以用 &amp;&amp; 连接，也可以写成一个shell脚本去执行。</span><br><span class="hljs-comment"># 例如 CMD cd /app &amp;&amp; ./start.sh</span><br>CMD node app.js<br></code></pre></td></tr></table></figure><h3 id="Build-为镜像和运行"><a href="#Build-为镜像和运行" class="headerlink" title="Build 为镜像和运行"></a>Build 为镜像和运行</h3><p>编译 </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker build -t <span class="hljs-built_in">test</span>:v1 <span class="hljs-comment">#-t 设置镜像名字和版本号</span><br></code></pre></td></tr></table></figure><p>命令参考：<a href="https://docs.docker.com/engine/reference/commandline/build/">https://docs.docker.com/engine/reference/commandline/build/</a><br>运行容器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker run -p 8080:8080 --name test-hello <span class="hljs-built_in">test</span>:v1<br></code></pre></td></tr></table></figure><p>-p 映射容器内端口到宿主机<br>–name 容器名字<br>-d 后台运行<br>命令参考文档：<a href="https://docs.docker.com/engine/reference/run/">https://docs.docker.com/engine/reference/run/</a></p><h3 id="更多相关命令"><a href="#更多相关命令" class="headerlink" title="更多相关命令"></a>更多相关命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker ps <span class="hljs-comment">#查看当前运行中的容器</span><br>docker images <span class="hljs-comment">#查看镜像列表</span><br>docker <span class="hljs-built_in">rm</span> container-id <span class="hljs-comment">#删除指定 id 的容器</span><br>docker stop/start container-id <span class="hljs-comment">#停止/启动指定 id 的容器</span><br>docker rmi image-id <span class="hljs-comment">#删除指定 id 的镜像</span><br>docker volume <span class="hljs-built_in">ls</span> <span class="hljs-comment">#查看 volume 列表</span><br>docker network <span class="hljs-built_in">ls</span> <span class="hljs-comment">#查看网络列表</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
